
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>How to implement a SDK in your own language and framework &#8212; test.ai SDK API 0.16 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="How to support interactive test case creation." href="supporting_interactive_test_case_creation.html" />
    <link rel="prev" title="Backend testcase API documentation" href="test_case_functions.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="how-to-implement-a-sdk-in-your-own-language-and-framework">
<h1>How to implement a SDK in your own language and framework<a class="headerlink" href="#how-to-implement-a-sdk-in-your-own-language-and-framework" title="Permalink to this headline">¶</a></h1>
<section id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<p>To effectively implement a SDK in your own language and framework, you need the ability to make HTTP POST requests, take screenshots and extract bounding boxes from the elements that you want to learn.</p>
</section>
<section id="conceptual-overview">
<h2>Conceptual overview<a class="headerlink" href="#conceptual-overview" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt>The SDK job can be segmented in two main parts:</dt><dd><ul class="simple">
<li><p>Ingestion: this is when we take screenshots as a test is running and save them alongside bounding boxes when running a test.</p></li>
<li><p>Classification: this is when we trigger the visual AI because the standard selector did not work.</p></li>
</ul>
</dd>
</dl>
<section id="ingestion">
<h3>Ingestion<a class="headerlink" href="#ingestion" title="Permalink to this headline">¶</a></h3>
<p>The general flow of ingestion is to basically check if a screenshot of the current page exists in the backend, if not then upload the screenshot and add an action_info for the element.
We somehow have to generate a label for the element automatically, we don’t cover it here, but in general you can use the selector (e.g xpath) as the name.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ingest_element</span><span class="p">(</span><span class="n">selector</span><span class="p">,</span> <span class="n">element</span><span class="p">):</span>
    <span class="n">screenshot</span> <span class="o">=</span> <span class="n">b64encode</span><span class="p">(</span><span class="n">driver</span><span class="o">.</span><span class="n">take_screenshot</span><span class="p">())</span>
    <span class="n">element_name</span> <span class="o">=</span> <span class="n">generate_element_name_from_selector</span><span class="p">(</span><span class="n">selector</span><span class="p">)</span> <span class="c1"># this will become the label for the element in the backend</span>
    <span class="n">bounding_box</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">bounding_box</span><span class="p">()</span> <span class="c1"># this will become the bounding box for the element in the backend</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">check_screenshot_exists</span><span class="p">(</span><span class="n">compute_hash</span><span class="p">(</span><span class="n">screenshot</span><span class="p">)):</span>
        <span class="n">upload_screenshot</span><span class="p">(</span><span class="n">screenshot</span><span class="p">)</span>
        <span class="n">add_action</span><span class="p">(</span><span class="n">element_name</span><span class="p">,</span> <span class="n">compute_hash</span><span class="p">(</span><span class="n">screenshot</span><span class="p">),</span> <span class="n">bounding_box</span><span class="p">)</span>

<span class="n">element</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_selector</span><span class="o">/</span><span class="n">xpath</span><span class="o">/</span><span class="nb">id</span><span class="o">/</span><span class="n">etc</span><span class="p">(</span><span class="n">selector</span><span class="p">)</span>
<span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">should_ingest_element</span><span class="p">:</span>
    <span class="n">ingest_element</span><span class="p">(</span><span class="n">selector</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span>
</pre></div>
</div>
<dl class="simple">
<dt>Here we use wrappers around the backend API functions (which should be POST requests):</dt><dd><ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">check_screenshot_exists()</span></code> wraps <a class="reference internal" href="backend.html#api.v1.backend.check_screenshot_exists" title="api.v1.backend.check_screenshot_exists"><code class="xref py py-func docutils literal notranslate"><span class="pre">api.v1.backend.check_screenshot_exists()</span></code></a> to check if a screenshot already exists in the backend</p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">upload_screenshot()</span></code> wraps <a class="reference internal" href="backend.html#api.v1.backend.upload_screenshot" title="api.v1.backend.upload_screenshot"><code class="xref py py-func docutils literal notranslate"><span class="pre">api.v1.backend.upload_screenshot()</span></code></a> to upload a screenshot to the backend</p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">add_action()</span></code> wraps <a class="reference internal" href="backend.html#api.v1.backend.add_action" title="api.v1.backend.add_action"><code class="xref py py-func docutils literal notranslate"><span class="pre">api.v1.backend.add_action()</span></code></a> to add an action to the backend</p></li>
</ul>
</dd>
</dl>
</section>
<section id="classification">
<h3>Classification<a class="headerlink" href="#classification" title="Permalink to this headline">¶</a></h3>
<p>The idea behind classification is to try and run the standard selector and if it fails to call the backend to visual find the element in the screenshot.
In the Python SDK for instance, we override the driver methods like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">find_element_by_selector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selector</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">element</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_selector</span><span class="p">(</span><span class="n">selector</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">NoSuchElementException</span><span class="p">:</span>
        <span class="c1"># Call the AI backend because the selector is broken</span>
        <span class="n">element</span> <span class="o">=</span> <span class="n">classify</span><span class="p">(</span><span class="n">b64encode</span><span class="p">(</span><span class="n">driver</span><span class="o">.</span><span class="n">take_screenshot</span><span class="p">()),</span> <span class="n">generate_element_name_from_selector</span><span class="p">(</span><span class="n">selector</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">element</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Could not find the element, please adjust your bounding box by going to https://sdk.test.ai/label/</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">generate_element_name_from_selector</span><span class="p">(</span><span class="n">selector</span><span class="p">))</span>
            <span class="k">raise</span> <span class="n">NoSuchElementException</span>
    <span class="k">return</span> <span class="n">element</span>
</pre></div>
</div>
<p>Here we use the function <code class="xref py py-func docutils literal notranslate"><span class="pre">classify()</span></code> to classify the element, it is a wrapper around the POST request to <a class="reference internal" href="backend.html#api.v1.backend.classify" title="api.v1.backend.classify"><code class="xref py py-func docutils literal notranslate"><span class="pre">api.v1.backend.classify()</span></code></a>.
Note when classify fails, it is generally a good idea to prompt the user to add a bounding box to that specific element, they can do so by going to <a class="reference external" href="https://sdk.test.ai/label">https://sdk.test.ai/label</a>/&lt;element_name&gt;</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">test.ai SDK API</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="backend.html">Base API</a></li>
<li class="toctree-l1"><a class="reference internal" href="test_case_functions.html">Interactive API</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Custom SDK</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#conceptual-overview">Conceptual overview</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="supporting_interactive_test_case_creation.html">Interactive testcases</a></li>
<li class="toctree-l1"><a class="reference internal" href="playwright_end_to_end_example.html">Playwright JS example</a></li>
<li class="toctree-l1"><a class="reference internal" href="webdriver_end_to_end_example.html">Webdriver JS example</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="test_case_functions.html" title="previous chapter">Backend testcase API documentation</a></li>
      <li>Next: <a href="supporting_interactive_test_case_creation.html" title="next chapter">How to support interactive test case creation.</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Etienne DEGUINE (etienne@test.ai), Alexander WU (alec@test.ai), Chris NAVRIDES (chris@test.ai).
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.4.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/api_backend/creating_a_SDK.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>